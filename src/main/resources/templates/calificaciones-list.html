<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Puntajes</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">

    <!-- Enlace al archivo CSS de Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css">

    <!-- Enlace al archivo JavaScript de jQuery (necesario para algunas funciones de Bootstrap) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Enlace al archivo JavaScript de Bootstrap -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>

    <!--FAVICON-->
    <link rel="shortcut icon" href="https://cdn-icons-png.flaticon.com/512/6854/6854590.png" type="image/x-icon">

    <!--FONT-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Righteous&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/cali.css">

    <style>
        body {
            background-color: #f8f9fa;
        }
        .custom-table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-size: 0.9em;
            font-family: 'Roboto Slab', serif;
            border: 1px solid #ddd;
        }
        .custom-table th, .custom-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        .nivel-verde { background-color: #d4edda; }
        .nivel-amarillo { background-color: #fff3cd; }
        .nivel-azul { background-color: #cce5ff; }
        .nivel-rojo { background-color: #f8d7da; }
    </style>
</head>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var nivelCells = document.querySelectorAll("td[class^='nivel-']");

        nivelCells.forEach(function (cell) {
            var nivel = cell.textContent.trim();
            if (nivel === "4") {
                cell.classList.add("nivel-verde");
            } else if (nivel === "3") {
                cell.classList.add("nivel-amarillo");
            } else if (nivel === "2") {
                cell.classList.add("nivel-azul");
            } else if (nivel === "1") {
                cell.classList.add("nivel-rojo");
            }
        });

        var rows = document.querySelectorAll("table tbody tr");
        rows.forEach(function (row) {
            var anuladoCell = row.querySelector("td:nth-child(3)");
            if (anuladoCell.textContent.trim().toLowerCase() === "si") {
                row.style.backgroundColor = "#FF8A81";
            }
        });
    });

    function calcularNivel(puntaje) {
        if (puntaje >= 191 && puntaje <= 300) {
            return 4;
        } else if (puntaje >= 156 && puntaje <= 190) {
            return 3;
        } else if (puntaje >= 126 && puntaje <= 155) {
            return 2;
        } else if (puntaje > 0 && puntaje <= 125) {
            return 1;
        } else if (puntaje == 0) {
            return 0;
        } else {
            return "N/A";
        }
    }

    function calcularIngles(puntaje) {
        if (puntaje >= 191 && puntaje <= 300) {
            return "B2";
        } else if (puntaje >= 156 && puntaje <= 190) {
            return "B1";
        } else if (puntaje >= 140 && puntaje <= 155) {
            return "A2";
        } else if (puntaje >= 125 && puntaje <= 140) {
            return "A1";
        } else if (puntaje >= 0 && puntaje <= 125) {
            return "A0";
        } else {
            return "N/A";
        }
    }
</script>

<body>
    <main>
        <div class="text-center">
            <h1 class="display-4 fw-bold text-primary mb-4">Puntajes</h1>
        </div>
        <div class="container" style="overflow-x: auto;">
            <table class="custom-table table-striped">
                <thead style="background-color: blue; color: white;">
                    <tr>
                        <th>Cédula</th>
                        <th>Número Registro</th>
                        <th>Anulado</th>
                        <th>Puntaje Total</th>
                        <th>Nivel Puntaje Total</th>
                        <th>Comunicación Escrita</th>
                        <th>Nivel Comunicación Escrita</th>
                        <th>Razonamiento Cuantitativo</th>
                        <th>Nivel Razonamiento Cuantitativo</th>
                        <th>Lectura Crítica</th>
                        <th>Nivel Lectura Crítica</th>
                        <th>Competencias Ciudadanas</th>
                        <th>Nivel Competencias Ciudadanas</th>
                        <th>Inglés</th>
                        <th>Nivel Inglés</th>
                        <th>Formulación Proyectos</th>
                        <th>Nivel Formulación Proyectos</th>
                        <th>Pensamiento Científico</th>
                        <th>Nivel Pensamiento Científico</th>
                        <th>Diseño de Software</th>
                        <th>Nivel Diseño de Software</th>
                        <th>Editar</th>
                        <th>Eliminar</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="calificacion : ${calificaciones}">
                        <td>[[${calificacion.estudiante.numeroDocumento}]]</td>
                        <td>[[${calificacion.estudiante.numeroRegistro}]]</td>
                        <td>[[${calificacion.anulado}]]</td>
                        <td th:text="${calificacion.puntajeTotal}"></td>
                        <td th:text="${calificacion.puntajeTotal}"></td>
                        <td th:text="${calificacion.comEscrita}"></td>
                        <td th:text="${calificacion.comEscrita}"></td>
                        <td th:text="${calificacion.razonCuantitativo}"></td>
                        <td th:text="${calificacion.razonCuantitativo}"></td>
                        <td th:text="${calificacion.lecturaCritica}"></td>
                        <td th:text="${calificacion.lecturaCritica}"></td>
                        <td th:text="${calificacion.compeCiudadanas}"></td>
                        <td th:text="${calificacion.compeCiudadanas}"></td>
                        <td th:text="${calificacion.ingles}"></td>
                        <td th:text="${calificacion.ingles}"></td>
                        <td th:text="${calificacion.formProyectos}"></td>
                        <td th:text="${calificacion.formProyectos}"></td>
                        <td th:text="${calificacion.penCientifico}"></td>
                        <td th:text="${calificacion.penCientifico}"></td>
                        <td th:text="${calificacion.disenoSoftware}"></td>
                        <td th:text="${calificacion.disenoSoftware}"></td>
                        <td>
                            <a class="btn btn-warning"
                               th:href="@{/calificaciones/edit/{id}(id=${calificacion.id})}">
                                Editar
                            </a>
                        </td>
                        <td>
                            <a class="btn btn-danger"
                               th:href="@{/calificaciones/delete/{id}(id=${calificacion.id})}"
                               onclick="return confirm('¿Estás seguro de que deseas eliminar esta calificación?');">
                                Eliminar
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="text-center mt-4">
            <a href="javascript:history.back()" class="btn btn-secondary">Volver</a> <!-- Botón "Volver" agregado -->
        </div>
    </main>
</body>

</html>
